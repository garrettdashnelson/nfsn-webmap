<!DOCTYPE html>
<meta charset="utf-8">
<head>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

<div id="map">
</div>

<div id="caption"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script>


var width = 800,
    height = 410;

var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);

var projection = d3.geo.mercator()
  	.scale(4800)
  	.center([-85.2, 37.5])
  	.translate([width/2, (height/2)+30]);
  
var path = d3.geo.path()
  	.projection(projection)
  	.pointRadius(4);

var caption = d3.select('#caption')
  

d3.json("data/ky-data.json", function(error, ky) {
  if (error) return console.error(error);

  
  var outline = topojson.feature(ky, ky.objects.ky);

  svg.append("path")
  	.datum(outline)
  	.attr("d", path)
  	.attr("class", "outline");

  var grants = topojson.feature(ky, ky.objects.kygrants);

  var sites = svg.append('g')
  	.attr('class','grants')
  	.selectAll('path')
  	.data(grants.features)
  	.enter().append('path')
  	.attr('d',path)
    .attr('class',demoSites);

  sites.on('mouseover',captDisplay)
  	.on('mouseout',function(){ caption.html(''); });
 	
});

function demoSites(d) {

     switch(d.properties.demo_site) { 
          case 'Boyle':
            return "single-grant bo"; 
          case 'Perry':
            return "single-grant pe";
          default:
            return "single-grant demo"
          }

}

function captDisplay(d) {
	caption.html(d.properties.school_name + " (" + d.properties.city + ")<br>" + d.properties.proj_name);
}

	
</script>
